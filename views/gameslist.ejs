<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LAPUTA</title>
    <link rel="icon" type="image/x-icon" href="/images/logo.png">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Bungee+Spice&family=Gochi+Hand&family=Homemade+Apple&family=Public+Sans:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    <style>
        *{
            margin: 0;
            box-sizing: border-box;
        }
        body{
            background-color: rgb(140, 177, 138);
        }
        .image{
            height: 100%;
            aspect-ratio: 1 / 1
        }
        .list-item{
            width: 100%;
            height: 100px;
            text-decoration: none;
        }
        #detailsbox,.modal-content{
            
            background-color: rgb(69, 95, 69);
        }
    </style>
</head>
<body class="vh-100 w-100">
    
    
       <%-include('navbar')%>
    <div class="p-3 d-flex row w-100 h-75 pt-5">
       <div id="list" class="col-12 col-md-5 d-flex flex-column gap-3 overflow-hidden">
            <% games.forEach((i)=>{ %>
                <a class="list-item d-flex align-items-center justify-content-between justify-content-md-start gap-2" data-description="<%=i.description%>" data-video="<%=i.video%>" data-name="<%=i.name%>" data-thumbnail="<%=i.thumbnail%>" data-route="<%=i.route%>" onclick="showDetails(this)">
                    <img class="image border rounded-5 h-100 " src="<%=i.thumbnail%>" alt="<%=i.name%>">
                    <span class="text-decoration-none fs-3 text-muted fw-bolder"><%=i.name%></span>
                    <button class="btn btn-success d-md-none ps-3 pe-3" data-bs-toggle="modal" data-bs-target="#detailsmodal" data-description="<%=i.description%>" data-video="<%=i.video%>" data-name="<%=i.name%>" data-thumbnail="<%=i.thumbnail%>" data-route="<%=i.route%>" onclick="modaldata(this)">VIEW</button>
                </a>
            <% }) %>
        </div>

        <div  class="text-center h-100  d-none d-md-block col-md-7" >
           <div id="detailsbox" class="h-100 w-100 d-flex flex-column align-items-center justify-content-evenly p-2 border rounded-5">
           </div>
        </div>

        <div class="modal fade " id="detailsmodal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="detailsmodalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content border-1 border-light-subtle">
                <div class="modal-header">
                    <h1 class="modal-title fs-3 text-light" id="detailsmodalLabel"></h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body d-flex flex-column justify-content-evenly align-items-center text-center" id="detailsmodalbody">
                    
                </div>
                <div class="modal-footer">
                    <a type="button" id="datailmodalbutton" class="btn btn-light ps-4 pe-4">PLAY</a>
                </div>
                </div>
            </div>
        </div>


    </div>

    <script>
        function showDetails(data){
            const name = data.dataset.name
            const route = data.dataset.route
            const thumbnail = data.dataset.thumbnail
            const video = data.dataset.video
            const description = data.dataset.description

            const detailsbox = document.getElementById('detailsbox')
            detailsbox.innerHTML = ''

            const heading = document.createElement('h1')
            heading.innerText = name
            heading.style.fontWeight = 'bolder'
            heading.style.color='white'

            const vdo = document.createElement('video')
            vdo.poster = thumbnail
            vdo.height = 200
            vdo.width = 400
            vdo.controls=false
            vdo.autoplay=true
            vdo.loop=true
            const source = document.createElement('source')
            source.src = video
            vdo.append(source)

            const p = document.createElement('p')
            p.innerText = description
            p.style.fontSize = '20px'
            p.style.color = 'white'

            const button = document.createElement('a')
            button.innerText = 'PLAY'
            button.style.fontWeight='bold'
            button.classList.add('btn')
            button.classList.add('btn-light')
            button.classList.add('btn-block')
            button.classList.add('w-50')
            button.href = route

            detailsbox.append(heading,vdo,p,button)

        }

        function modaldata(data){
            const name = data.dataset.name
            const route = data.dataset.route
            const thumbnail = data.dataset.thumbnail
            const video = data.dataset.video
            const description = data.dataset.description

            const detailsmodalLabel = document.getElementById('detailsmodalLabel')
            detailsmodalLabel.innerText=name

            const detailsmodalbody = document.getElementById('detailsmodalbody')
            detailsmodalbody.innerHTML = `<video poster="${thumbnail}" class="img-fluid" height="200" width="400" autoplay loop><source src="${video}"></video><p style="font-size:20px;color:white">${description}</p>`

            const detailmodalbutton = document.getElementById('datailmodalbutton')
            detailmodalbutton.href = route
        }
    </script>
</body>
</html>